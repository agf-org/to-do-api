name: redeploy

on: 
  workflow_dispatch:

jobs:
  redeploy:
    runs-on: self-hosted
    steps:
      - name: Deploy containers
        run: |
          echo "TO_DO_API_TAG=latest" >> .env
          echo "NODE_ENV=production" >> .env
          docker-compose down || true
          docker-compose pull to-do-api
          docker-compose up -d
          rm .env
